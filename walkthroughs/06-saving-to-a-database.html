
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <title>ä¿å­˜åˆ°æ•°æ®åº“ Â· Slate ä¸­æ–‡æ–‡æ¡£</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 4.0.4">
        <meta name="author" content="mowangjuanzi">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/@honkit/honkit-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="xx-using-the-bundled-source.html" />
    
    
    <link rel="prev" href="05-executing-commands.html" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="è¾“å…¥å¹¶æœç´¢" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    ç®€ä»‹
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">æ¼”ç¤º</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="01-installing-slate.html">
            
                <a href="01-installing-slate.html">
            
                    
                    å®‰è£… Slate
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="02-adding-event-handlers.html">
            
                <a href="02-adding-event-handlers.html">
            
                    
                    æ·»åŠ äº‹ä»¶å¤„ç†ç¨‹åº
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="03-defining-custom-elements.html">
            
                <a href="03-defining-custom-elements.html">
            
                    
                    å®šä¹‰è‡ªå®šä¹‰å…ƒç´ 
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="04-applying-custom-formatting.html">
            
                <a href="04-applying-custom-formatting.html">
            
                    
                    åº”ç”¨è‡ªå®šä¹‰æ ¼å¼
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="05-executing-commands.html">
            
                <a href="05-executing-commands.html">
            
                    
                    æ‰§è¡Œå‘½ä»¤
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="2.6" data-path="06-saving-to-a-database.html">
            
                <a href="06-saving-to-a-database.html">
            
                    
                    ä¿å­˜åˆ°æ•°æ®åº“
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="xx-using-the-bundled-source.html">
            
                <a href="xx-using-the-bundled-source.html">
            
                    
                    ä½¿ç”¨å·²æ‰“åŒ…æº
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">æ¦‚å¿µ</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../concepts/01-interfaces.html">
            
                <a href="../concepts/01-interfaces.html">
            
                    
                    æ¥å£
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../concepts/02-nodes.html">
            
                <a href="../concepts/02-nodes.html">
            
                    
                    èŠ‚ç‚¹
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../concepts/03-locations.html">
            
                <a href="../concepts/03-locations.html">
            
                    
                    ä½ç½®
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="../concepts/04-transforms.html">
            
                <a href="../concepts/04-transforms.html">
            
                    
                    è½¬æ¢
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="../concepts/05-operations.html">
            
                <a href="../concepts/05-operations.html">
            
                    
                    æ“ä½œ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="../concepts/06-commands.html">
            
                <a href="../concepts/06-commands.html">
            
                    
                    å‘½ä»¤
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="../concepts/07-editor.html">
            
                <a href="../concepts/07-editor.html">
            
                    
                    ç¼–è¾‘å™¨
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.8" data-path="../concepts/08-plugins.html">
            
                <a href="../concepts/08-plugins.html">
            
                    
                    æ’ä»¶
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.9" data-path="../concepts/09-rendering.html">
            
                <a href="../concepts/09-rendering.html">
            
                    
                    æ¸²æŸ“
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.10" data-path="../concepts/10-serializing.html">
            
                <a href="../concepts/10-serializing.html">
            
                    
                    åºåˆ—åŒ–
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.11" data-path="../concepts/11-normalizing.html">
            
                <a href="../concepts/11-normalizing.html">
            
                    
                    æ ‡å‡†åŒ–
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.12" data-path="../concepts/12-typescript.html">
            
                <a href="../concepts/12-typescript.html">
            
                    
                    TypeScript
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.13" data-path="../concepts/xx-migrating.html">
            
                <a href="../concepts/xx-migrating.html">
            
                    
                    è¿ç§»
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">API</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../api/transforms.html">
            
                <a href="../api/transforms.html">
            
                    
                    Transform
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../api/nodes/">
            
                <a href="../api/nodes/">
            
                    
                    Node ç±»å‹
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.1" data-path="../api/nodes/editor.html">
            
                <a href="../api/nodes/editor.html">
            
                    
                    Editor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.2" data-path="../api/nodes/element.html">
            
                <a href="../api/nodes/element.html">
            
                    
                    Element
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.3" data-path="../api/nodes/node.html">
            
                <a href="../api/nodes/node.html">
            
                    
                    Node
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.4" data-path="../api/nodes/node-entry.html">
            
                <a href="../api/nodes/node-entry.html">
            
                    
                    NodeEntry
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.5" data-path="../api/nodes/text.html">
            
                <a href="../api/nodes/text.html">
            
                    
                    Text
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="../api/locations/">
            
                <a href="../api/locations/">
            
                    
                    Location ç±»å‹
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.3.1" data-path="../api/locations/location.html">
            
                <a href="../api/locations/location.html">
            
                    
                    Location
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.2" data-path="../api/locations/path.html">
            
                <a href="../api/locations/path.html">
            
                    
                    Path
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.3" data-path="../api/locations/path-ref.html">
            
                <a href="../api/locations/path-ref.html">
            
                    
                    PathRef
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.4" data-path="../api/locations/point.html">
            
                <a href="../api/locations/point.html">
            
                    
                    Point
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.5" data-path="../api/locations/point-entry.html">
            
                <a href="../api/locations/point-entry.html">
            
                    
                    PointEntry
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.6" data-path="../api/locations/point-ref.html">
            
                <a href="../api/locations/point-ref.html">
            
                    
                    PointRef
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.7" data-path="../api/locations/range.html">
            
                <a href="../api/locations/range.html">
            
                    
                    Range
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.8" data-path="../api/locations/range-ref.html">
            
                <a href="../api/locations/range-ref.html">
            
                    
                    RangeRef
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.9" data-path="../api/locations/span.html">
            
                <a href="../api/locations/span.html">
            
                    
                    Span
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="../api/operation.html">
            
                <a href="../api/operation.html">
            
                    
                    Operation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="../api/scrubber.html">
            
                <a href="../api/scrubber.html">
            
                    
                    Scrubber
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">åº“</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../libraries/slate-react.html">
            
                <a href="../libraries/slate-react.html">
            
                    
                    Slate React
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../libraries/slate-history.html">
            
                <a href="../libraries/slate-history.html">
            
                    
                    Slate History
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="../libraries/slate-hyperscript.html">
            
                <a href="../libraries/slate-hyperscript.html">
            
                    
                    Slate Hyperscript
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">é€šç”¨</li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../general/resources.html">
            
                <a href="../general/resources.html">
            
                    
                    èµ„æº
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="../general/contributing.html">
            
                <a href="../general/contributing.html">
            
                    
                    è´¡çŒ®
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3" data-path="../general/changelog.html">
            
                <a href="../general/changelog.html">
            
                    
                    æ›´æ–°æ—¥å¿—
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.4" data-path="../general/faq.html">
            
                <a href="../general/faq.html">
            
                    
                    å¸¸è§é—®é¢˜
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            æœ¬ä¹¦ä½¿ç”¨ HonKit å‘å¸ƒ
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >ä¿å­˜åˆ°æ•°æ®åº“</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="ä¿å­˜åˆ°æ•°æ®åº“">ä¿å­˜åˆ°æ•°æ®åº“</h1>
<blockquote>
<p>Commit ID: <a href="https://github.com/ianstormtaylor/slate/blob/main/docs/walkthroughs/06-saving-to-a-database.md" target="_blank">abea3a3dd47ea53f35090d4041be21cbf8dcdbe7</a></p>
</blockquote>
<p>ç°åœ¨å·²ç»å­¦ä¹ äº†å¦‚ä½•å‘ Slate ç¼–è¾‘å™¨æ·»åŠ åŠŸèƒ½çš„åŸºç¡€çŸ¥è¯†ï¼Œé‚£å¦‚ä½•ä¿å­˜æ­£åœ¨ç¼–è¾‘çš„å†…å®¹ï¼Œä»¥ä¾¿ç¨åå›åˆ°åº”ç”¨ç¨‹åºåè¿˜èƒ½ç»§ç»­åŠ è½½å‘¢ã€‚</p>
<p>åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œå°†å±•ç¤ºå¦‚ä½•æ·»åŠ é€»è¾‘ä»¥ä¾¿å°† Slate å†…å®¹ä¿å­˜åˆ°æ•°æ®åº“ä¸­å­˜å‚¨,å¹¶ä¸”ä»¥åå¯ä»¥æ£€ç´¢ã€‚</p>
<p>å…ˆä»åŸºç¡€çš„ç¼–è¾‘å™¨å¼€å§‹ï¼š</p>
<pre><code class="lang-jsx"><span class="hljs-keyword">const</span> initialValue = [
  {
    <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;paragraph&apos;</span>,
    <span class="hljs-attr">children</span>: [{ <span class="hljs-attr">text</span>: <span class="hljs-string">&apos;A line of text in a paragraph.&apos;</span> }],
  },
]

<span class="hljs-keyword">const</span> App = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> [editor] = useState(<span class="hljs-function">() =&gt;</span> withReact(createEditor()))

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Slate</span> <span class="hljs-attr">editor</span>=<span class="hljs-string">{editor}</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{initialValue}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Editable</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Slate</span>&gt;</span></span>
  )
}
</code></pre>
<p>åœ¨é¡µé¢ä¸Šæ¸²æŸ“ä¸€ä¸ªåŸºç¡€çš„ç¼–è¾‘å™¨ä¸”å½“è¾“å…¥å†…å®¹æ—¶ä¼šå‘ç”Ÿæ”¹å˜ã€‚ä½†æ˜¯å¦‚æœåˆ·æ–°é¡µé¢ï¼Œä¸€åˆ‡éƒ½ä¼šæ¢å¤åˆ°æœ€å¼€å§‹çš„æ ·å­ â€”â€” æ²¡æœ‰ä¿å­˜ä»»ä½•å†…å®¹ï¼</p>
<p>è¿™é‡Œéœ€è¦åšçš„æ˜¯å°†æ›´æ”¹ä¿å­˜åˆ°ä¸€ä¸ªåœ°æ–¹ã€‚åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œè™½ç„¶åªæ˜¯ä½¿ç”¨<a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage" target="_blank">Local Storage</a>ï¼ˆ<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/localStorage" target="_blank">æœ¬åœ°å­˜å‚¨</a>ï¼‰ï¼Œä½†æ˜¯ä¼šäº†è§£éœ€è¦åœ¨å“ªé‡Œæ·»åŠ æ•°æ®åº“é’©å­ã€‚</p>
<p>æ‰€ä»¥åœ¨ <code>onChange</code> å¤„ç†ç¨‹åºä¸­éœ€è¦æ·»åŠ åœ¨é™¤äº† <code>set_selection</code> ä¹‹å¤–çš„å†…å®¹æ›´æ”¹æ—¶ä¿å­˜ <code>value</code>ï¼š</p>
<pre><code class="lang-jsx"><span class="hljs-keyword">const</span> initialValue = [
  {
    <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;paragraph&apos;</span>,
    <span class="hljs-attr">children</span>: [{ <span class="hljs-attr">text</span>: <span class="hljs-string">&apos;A line of text in a paragraph.&apos;</span> }],
  },
]

<span class="hljs-keyword">const</span> App = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> [editor] = useState(<span class="hljs-function">() =&gt;</span> withReact(createEditor()))

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Slate</span>
      <span class="hljs-attr">editor</span>=<span class="hljs-string">{editor}</span>
      <span class="hljs-attr">value</span>=<span class="hljs-string">{initialValue}</span>
      <span class="hljs-attr">onChange</span>=<span class="hljs-string">{value</span> =&gt;</span> {
        const isAstChange = editor.operations.some(
          op =&gt; &apos;set_selection&apos; !== op.type
        )
        if (isAstChange) {
          // ä¿å­˜å€¼åˆ°æœ¬åœ°å­˜å‚¨ã€‚
          const content = JSON.stringify(value)
          localStorage.setItem(&apos;content&apos;, content)
        }
      }}
    &gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">Editable</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Slate</span>&gt;</span></span>
  )
}
</code></pre>
<p>ç°åœ¨æ¯å½“ç¼–è¾‘é¡µé¢ï¼Œå¦‚æœæŸ¥çœ‹æœ¬åœ°å­˜å‚¨ï¼Œåº”è¯¥ä¼šçœ‹åˆ° <code>content</code> å€¼å‘ç”Ÿå˜åŒ–ã€‚</p>
<p>ä½†ã€‚ã€‚ã€‚å¦‚æœåˆ·æ–°é¡µé¢ï¼Œä¸€åˆ‡éƒ½ä¼šé‡ç½®ã€‚è¿™æ˜¯å› ä¸ºéœ€è¦ç¡®ä¿ä»åŒä¸€ä¸ªæœ¬åœ°å­˜å‚¨ä½ç½®æ‹‰å–åˆå§‹å€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="lang-jsx"><span class="hljs-keyword">const</span> App = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> [editor] = useState(<span class="hljs-function">() =&gt;</span> withReact(createEditor()))
  <span class="hljs-comment">// å¦‚æœå­˜åœ¨ï¼Œåˆ™ä»æœ¬åœ°å­˜å‚¨æ‹‰å–åˆå§‹åŒ–å†…å®¹ã€‚</span>
  <span class="hljs-keyword">const</span> initialValue = useMemo(
    <span class="hljs-function">() =&gt;</span>
      <span class="hljs-built_in">JSON</span>.parse(<span class="hljs-built_in">localStorage</span>.getItem(<span class="hljs-string">&apos;content&apos;</span>)) || [
        {
          <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;paragraph&apos;</span>,
          <span class="hljs-attr">children</span>: [{ <span class="hljs-attr">text</span>: <span class="hljs-string">&apos;A line of text in a paragraph.&apos;</span> }],
        },
      ],
    []
  )

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Slate</span>
      <span class="hljs-attr">editor</span>=<span class="hljs-string">{editor}</span>
      <span class="hljs-attr">value</span>=<span class="hljs-string">{initialValue}</span>
      <span class="hljs-attr">onChange</span>=<span class="hljs-string">{value</span> =&gt;</span> {
        const isAstChange = editor.operations.some(
          op =&gt; &apos;set_selection&apos; !== op.type
        )
        if (isAstChange) {
          // ä¿å­˜å€¼åˆ°æœ¬åœ°å­˜å‚¨ã€‚
          const content = JSON.stringify(value)
          localStorage.setItem(&apos;content&apos;, content)
        }
      }}
    &gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">Editable</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Slate</span>&gt;</span></span>
  )
}
</code></pre>
<p>ç°åœ¨åº”è¯¥åœ¨åˆ·æ–°æ—¶ä¿å­˜æ›´æ”¹äº†ï¼</p>
<p>æˆåŠŸ â€”â€” åœ¨æ•°æ®åº“ä¸­å·²åŒ…å« JSONã€‚</p>
<p>ä½†æ˜¯å¦‚æœä½ æƒ³è¦ JSON æ„å¤–çš„ä¸œè¥¿å‘¢ï¼Ÿæ˜¯çš„ï¼Œéœ€è¦ç”¨ä¸åŒçš„æ–¹å¼åºåˆ—åŒ–å€¼ã€‚ä¾‹å¦‚å°†å†…å®¹ä¿å­˜ä¸ºçº¯æ–‡æœ¬è€Œä¸æ˜¯ JSONï¼Œå¯ä»¥ç¼–å†™ä¸€äº›åºåˆ—åŒ–å’Œååºåˆ—åŒ–çº¯æ–‡æœ¬å€¼ï¼š</p>
<pre><code class="lang-jsx"><span class="hljs-comment">// ä» Slate ä¸­å¯¼å…¥ `Node` åŠ©æ‰‹æ¥å£ã€‚</span>
<span class="hljs-keyword">import</span> { Node } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;slate&apos;</span>

<span class="hljs-comment">// å®šä¹‰æ¥å—å€¼å¹¶è¿”å›å­—ç¬¦ä¸²çš„åºåˆ—åŒ–å‡½æ•°ã€‚</span>
<span class="hljs-keyword">const</span> serialize = <span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> {
  <span class="hljs-keyword">return</span> (
    value
      <span class="hljs-comment">// åœ¨å€¼çš„å­é¡¹ä¸­è¿”å›æ¯ä¸ªæ®µè½çš„å­—ç¬¦ä¸²å†…å®¹ã€‚</span>
      .map(<span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> Node.string(n))
      <span class="hljs-comment">// ç”¨è¡¨ç¤ºæ®µè½çš„æ¢è¡Œç¬¦å°†å…¶ä¸²è”èµ·æ¥ã€‚</span>
      .join(<span class="hljs-string">&apos;\n&apos;</span>)
  )
}

<span class="hljs-comment">// å®šä¹‰æ¥å—å­—ç¬¦ä¸²è¿”å›å€¼çš„ååºåˆ—åŒ–å‡½æ•°ã€‚</span>
<span class="hljs-keyword">const</span> deserialize = <span class="hljs-function"><span class="hljs-params">string</span> =&gt;</span> {
  <span class="hljs-comment">// é€šè¿‡æ‹†åˆ†å­—ç¬¦ä¸²æå–å­çº§å€¼æ•°ç»„ã€‚</span>
  <span class="hljs-keyword">return</span> string.split(<span class="hljs-string">&apos;\n&apos;</span>).map(<span class="hljs-function"><span class="hljs-params">line</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">children</span>: [{ <span class="hljs-attr">text</span>: line }],
    }
  })
}

<span class="hljs-keyword">const</span> App = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> [editor] = useState(<span class="hljs-function">() =&gt;</span> withReact(createEditor()))
  <span class="hljs-comment">// ä½¿ç”¨ååºåˆ—åŒ–å‡½æ•°ä»æœ¬åœ°å­˜å‚¨ä¸­è¯»å–æ•°æ®ã€‚</span>
  <span class="hljs-keyword">const</span> initialValue = useMemo(
    deserialize(<span class="hljs-built_in">localStorage</span>.getItem(<span class="hljs-string">&apos;content&apos;</span>)) || <span class="hljs-string">&apos;&apos;</span>,
    []
  )

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Slate</span>
      <span class="hljs-attr">editor</span>=<span class="hljs-string">{editor}</span>
      <span class="hljs-attr">value</span>=<span class="hljs-string">{initialValue}</span>
      <span class="hljs-attr">onChange</span>=<span class="hljs-string">{value</span> =&gt;</span> {
        const isAstChange = editor.operations.some(
          op =&gt; &apos;set_selection&apos; !== op.type
        )
        if (isAstChange) {
          // åºåˆ—åŒ–å€¼å¹¶å°†å­—ç¬¦ä¸²ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨ã€‚
          localStorage.setItem(&apos;content&apos;, serialize(value))
        }
      }}
    &gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">Editable</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Slate</span>&gt;</span></span>
  )
}
</code></pre>
<p>æ£’ï¼ç°åœ¨æ­£åœ¨ä½¿ç”¨çº¯æ–‡æœ¬ã€‚</p>
<p>å¯ä»¥å¯¹å–œæ¬¢çš„æ ¼å¼æ¨¡ä»¿æ­¤ç­–ç•¥ã€‚å¯ä»¥åºåˆ—åŒ–ä¸º HTMLã€ Markdown æˆ–è€…ä¸ºæ¡ˆä¾‹é‡èº«å®šåˆ¶çš„è‡ªå®šä¹‰ JSON æ ¼å¼ã€‚</p>
<blockquote>
<p>ğŸ¤– æ³¨æ„ï¼Œå³ä½¿<em>å¯ä»¥</em>æŒ‰ç…§ä¸ªäººå–œå¥½åºåˆ—åŒ–å†…å®¹ï¼Œä¹Ÿè¦æƒè¡¡å–èˆã€‚åºåˆ—åŒ–è¿‡ç¨‹æœ‰æˆæœ¬ï¼ŒæŸäº›æ ¼å¼å¯èƒ½ä¼šæ¯”å…¶å®ƒæ ¼å¼æ›´éš¾å¤„ç†ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä»…å»ºè®®æ¡ˆä¾‹æœ‰ç‰¹æ®Šéœ€æ±‚æ—¶æ‰ç¼–å†™è‡ªå·±çš„æ ¼å¼ã€‚å¦åˆ™ï¼Œæœ€å¥½å°†æ•°æ®ä¿å­˜ä¸º Slate ä½¿ç”¨çš„æ ¼å¼ã€‚</p>
</blockquote>
<p>å¦‚æœä½ æƒ³æ›´æ–°ç¼–è¾‘å™¨çš„å†…å®¹æ—¶å“åº” Slate ä¹‹å¤–çš„äº‹ä»¶ï¼Œéœ€è¦ç›´æ¥ä¿®æ”¹ children å±æ€§ã€‚æœ€ç®€å•çš„æ–¹å¼æ˜¯æ›¿æ¢ editor.children çš„å€¼ <code>editor.children = newValue</code> å¹¶è§¦å‘é‡æ–°æ¸²æŸ“ï¼ˆä¾‹å¦‚ï¼Œåœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­è°ƒç”¨ <code>editor.onChange()</code>ï¼‰ã€‚æˆ–è€…ï¼Œå¯ä»¥ä½¿ç”¨ Slate å†…éƒ¨æ“ä½œæ¥è½¬æ¢å€¼ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="lang-javascript">  <span class="hljs-comment">/**
  * resetNodes é‡ç½®ç¼–è¾‘å™¨çš„å€¼ã€‚
  * éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¼ é€’ `at` å‚æ•°å¯èƒ½ä¼šå¯¼è‡´ â€œCannot resolve a DOM point from Slate pointâ€ é”™è¯¯ã€‚
  */</span>
  resetNodes&lt;T <span class="hljs-keyword">extends</span> Node&gt;(
    editor: Editor,
    <span class="hljs-attr">options</span>: {
      nodes?: Node | Node[],
      at?: Location
    } = {}
  ): <span class="hljs-keyword">void</span> {
    <span class="hljs-keyword">const</span> children = [...editor.children]

    children.forEach(<span class="hljs-function">(<span class="hljs-params">node</span>) =&gt;</span> editor.apply({ <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;remove_node&apos;</span>, <span class="hljs-attr">path</span>: [<span class="hljs-number">0</span>], node }))

    <span class="hljs-keyword">if</span> (options.nodes) {
      <span class="hljs-keyword">const</span> nodes = Node.isNode(options.nodes) ? [options.nodes] : options.nodes

      nodes.forEach(<span class="hljs-function">(<span class="hljs-params">node, i</span>) =&gt;</span> editor.apply({ <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;insert_node&apos;</span>, <span class="hljs-attr">path</span>: [i], <span class="hljs-attr">node</span>: node }))
    }

    <span class="hljs-keyword">const</span> point = options.at &amp;&amp; Point.isPoint(options.at)
      ? options.at
      : Editor.end(editor, [])

    <span class="hljs-keyword">if</span> (point) {
      Transforms.select(editor, point)
    }
  }
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="05-executing-commands.html" class="navigation navigation-prev " aria-label="Previous page: æ‰§è¡Œå‘½ä»¤">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="xx-using-the-bundled-source.html" class="navigation navigation-next " aria-label="Next page: ä½¿ç”¨å·²æ‰“åŒ…æº">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"ä¿å­˜åˆ°æ•°æ®åº“","level":"2.6","depth":1,"next":{"title":"ä½¿ç”¨å·²æ‰“åŒ…æº","level":"2.7","depth":1,"path":"walkthroughs/xx-using-the-bundled-source.md","ref":"walkthroughs/xx-using-the-bundled-source.md","articles":[]},"previous":{"title":"æ‰§è¡Œå‘½ä»¤","level":"2.5","depth":1,"path":"walkthroughs/05-executing-commands.md","ref":"walkthroughs/05-executing-commands.md","articles":[]},"dir":"ltr"},"config":{"plugins":[],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"mowangjuanzi","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"structure":{"langs":"LANGS.md","readme":"Introduction.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Slate ä¸­æ–‡æ–‡æ¡£","language":"zh-hans","gitbook":"*"},"file":{"path":"walkthroughs/06-saving-to-a-database.md","mtime":"2023-03-04T16:00:32.019Z","type":"markdown"},"gitbook":{"version":"4.0.4","time":"2023-03-04T16:00:35.915Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

