
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <title>Transforms · Slate 中文文档</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 3.7.3">
        <meta name="author" content="mowangjuanzi">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/@honkit/honkit-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="05-operations.html" />
    
    
    <link rel="prev" href="03-locations.html" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    简介
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">演示</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../walkthroughs/01-installing-slate.html">
            
                <a href="../walkthroughs/01-installing-slate.html">
            
                    
                    安装 Slate
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../walkthroughs/02-adding-event-handlers.html">
            
                <a href="../walkthroughs/02-adding-event-handlers.html">
            
                    
                    添加事件处理程序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../walkthroughs/03-defining-custom-elements.html">
            
                <a href="../walkthroughs/03-defining-custom-elements.html">
            
                    
                    定义自定义元素
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../walkthroughs/04-applying-custom-formatting.html">
            
                <a href="../walkthroughs/04-applying-custom-formatting.html">
            
                    
                    应用自定义格式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="../walkthroughs/05-executing-commands.html">
            
                <a href="../walkthroughs/05-executing-commands.html">
            
                    
                    Executing Commands
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="../walkthroughs/06-saving-to-a-database.html">
            
                <a href="../walkthroughs/06-saving-to-a-database.html">
            
                    
                    Saving to a Database
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="../walkthroughs/xx-using-the-bundled-source.html">
            
                <a href="../walkthroughs/xx-using-the-bundled-source.html">
            
                    
                    Using the Bundled Source
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Concepts</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="01-interfaces.html">
            
                <a href="01-interfaces.html">
            
                    
                    Interfaces
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="02-nodes.html">
            
                <a href="02-nodes.html">
            
                    
                    Nodes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="03-locations.html">
            
                <a href="03-locations.html">
            
                    
                    Locations
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="3.4" data-path="04-transforms.html">
            
                <a href="04-transforms.html">
            
                    
                    Transforms
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="05-operations.html">
            
                <a href="05-operations.html">
            
                    
                    Operations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="06-commands.html">
            
                <a href="06-commands.html">
            
                    
                    Commands
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="07-editor.html">
            
                <a href="07-editor.html">
            
                    
                    Editor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.8" data-path="08-plugins.html">
            
                <a href="08-plugins.html">
            
                    
                    Plugins
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.9" data-path="09-rendering.html">
            
                <a href="09-rendering.html">
            
                    
                    Rendering
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.10" data-path="10-serializing.html">
            
                <a href="10-serializing.html">
            
                    
                    Serializing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.11" data-path="11-normalizing.html">
            
                <a href="11-normalizing.html">
            
                    
                    Normalizing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.12" data-path="12-typescript.html">
            
                <a href="12-typescript.html">
            
                    
                    TypeScript
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.13" data-path="xx-migrating.html">
            
                <a href="xx-migrating.html">
            
                    
                    Migrating
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">API</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../api/transforms.html">
            
                <a href="../api/transforms.html">
            
                    
                    Transforms
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../api/nodes/">
            
                <a href="../api/nodes/">
            
                    
                    Node Types
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.1" data-path="../api/nodes/editor.html">
            
                <a href="../api/nodes/editor.html">
            
                    
                    Editor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.2" data-path="../api/nodes/element.html">
            
                <a href="../api/nodes/element.html">
            
                    
                    Element
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.3" data-path="../api/nodes/node.html">
            
                <a href="../api/nodes/node.html">
            
                    
                    Node
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.4" data-path="../api/nodes/node-entry.html">
            
                <a href="../api/nodes/node-entry.html">
            
                    
                    NodeEntry
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.5" data-path="../api/nodes/text.html">
            
                <a href="../api/nodes/text.html">
            
                    
                    Text
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="../api/locations/">
            
                <a href="../api/locations/">
            
                    
                    Location Types
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.3.1" data-path="../api/locations/location.html">
            
                <a href="../api/locations/location.html">
            
                    
                    Location
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.2" data-path="../api/locations/path.html">
            
                <a href="../api/locations/path.html">
            
                    
                    Path
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.3" data-path="../api/locations/path-ref.html">
            
                <a href="../api/locations/path-ref.html">
            
                    
                    PathRef
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.4" data-path="../api/locations/point.html">
            
                <a href="../api/locations/point.html">
            
                    
                    Point
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.5" data-path="../api/locations/point-entry.html">
            
                <a href="../api/locations/point-entry.html">
            
                    
                    PointEntry
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.6" data-path="../api/locations/point-ref.html">
            
                <a href="../api/locations/point-ref.html">
            
                    
                    PointRef
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.7" data-path="../api/locations/range.html">
            
                <a href="../api/locations/range.html">
            
                    
                    Range
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.8" data-path="../api/locations/range-ref.html">
            
                <a href="../api/locations/range-ref.html">
            
                    
                    RangeRef
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.9" data-path="../api/locations/span.html">
            
                <a href="../api/locations/span.html">
            
                    
                    Span
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="../api/operation.html">
            
                <a href="../api/operation.html">
            
                    
                    Operation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="../api/scrubber.html">
            
                <a href="../api/scrubber.html">
            
                    
                    Scrubber
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Libraries</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../libraries/slate-react.html">
            
                <a href="../libraries/slate-react.html">
            
                    
                    Slate React
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../libraries/slate-history.html">
            
                <a href="../libraries/slate-history.html">
            
                    
                    Slate History
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="../libraries/slate-hyperscript.html">
            
                <a href="../libraries/slate-hyperscript.html">
            
                    
                    Slate Hyperscript
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">General</li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../general/resources.html">
            
                <a href="../general/resources.html">
            
                    
                    Resources
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="../general/contributing.html">
            
                <a href="../general/contributing.html">
            
                    
                    Contributing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3" data-path="../general/changelog.html">
            
                <a href="../general/changelog.html">
            
                    
                    Changelog
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.4" data-path="../general/faq.html">
            
                <a href="../general/faq.html">
            
                    
                    FAQ
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            本书使用 HonKit 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Transforms</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="transforms">Transforms</h1>
<p>Slate&apos;s data structure is immutable, so you can&apos;t modify or delete nodes directly. Instead, Slate comes with a collection of &quot;transform&quot; functions that let you change your editor&apos;s value.</p>
<p>Slate&apos;s transform functions are designed to be very flexible, to make it possible to represent all kinds of changes you might need to make to your editor. However, that flexibility can be hard to understand at first.</p>
<p>Typically, you&apos;ll apply a single operation to zero or more Nodes. For example, here&apos;s how you flatten the syntax tree,
by applying <code>unwrapNodes</code> to every parent of block Elements:</p>
<pre><code class="lang-js">Transforms.unwrapNodes(editor, {
  <span class="hljs-attr">at</span>: [], <span class="hljs-comment">// Path of Editor</span>
  <span class="hljs-attr">match</span>: <span class="hljs-function"><span class="hljs-params">node</span> =&gt;</span>
    !Editor.isEditor(node) &amp;&amp;
    node.children?.every(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span> Editor.isBlock(editor, child)),
  <span class="hljs-attr">mode</span>: <span class="hljs-string">&apos;all&apos;</span>, <span class="hljs-comment">// also the Editor&apos;s children</span>
})
</code></pre>
<p>Non-standard operations (or debugging/tracing which Nodes will be affected by a set of NodeOptions) may require using
<code>Editor.nodes</code> to create a JavaScript Iterator of NodeEntries and a for..of loop to act.
For example, to replace all image elements with their alt text:</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> imageElmnts = Editor.nodes(editor, {
  <span class="hljs-attr">at</span>: [], <span class="hljs-comment">// Path of Editor</span>
  <span class="hljs-attr">match</span>: <span class="hljs-function">(<span class="hljs-params">node, path</span>) =&gt;</span> <span class="hljs-string">&apos;image&apos;</span> === node.type,
  <span class="hljs-comment">// mode defaults to &quot;all&quot;, so this also searches the Editor&apos;s children</span>
})
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> nodeEntry <span class="hljs-keyword">of</span> imageElmnts) {
  <span class="hljs-keyword">const</span> altText =
    nodeEntry[<span class="hljs-number">0</span>].alt ||
    nodeEntry[<span class="hljs-number">0</span>].title ||
    <span class="hljs-regexp">/\/([^/]+)$/</span>.exec(nodeEntry[<span class="hljs-number">0</span>].url)?.[<span class="hljs-number">1</span>] ||
    <span class="hljs-string">&apos;☹︎&apos;</span>
  Transforms.select(editor, nodeEntry[<span class="hljs-number">1</span>])
  Editor.insertFragment(editor, [{ <span class="hljs-attr">text</span>: altText }])
}
</code></pre>
<blockquote>
<p>🤖 Check out the <a href="../api/transforms.html">Transforms</a> reference for a full list of Slate&apos;s transforms.</p>
</blockquote>
<h2 id="selection-transforms">Selection Transforms</h2>
<p>Selection-related transforms are some of the simpler ones. For example, here&apos;s how you set the selection to a new range:</p>
<pre><code class="lang-js">Transforms.select(editor, {
  <span class="hljs-attr">anchor</span>: { <span class="hljs-attr">path</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>], <span class="hljs-attr">offset</span>: <span class="hljs-number">0</span> },
  <span class="hljs-attr">focus</span>: { <span class="hljs-attr">path</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>], <span class="hljs-attr">offset</span>: <span class="hljs-number">2</span> },
})
</code></pre>
<p>But they can be more complex too.</p>
<p>For example, it&apos;s common to need to move a cursor forwards or backwards by varying distances—by character, by word, by line. Here&apos;s how you&apos;d move the cursor backwards by three words:</p>
<pre><code class="lang-js">Transforms.move(editor, {
  <span class="hljs-attr">distance</span>: <span class="hljs-number">3</span>,
  <span class="hljs-attr">unit</span>: <span class="hljs-string">&apos;word&apos;</span>,
  <span class="hljs-attr">reverse</span>: <span class="hljs-literal">true</span>,
})
</code></pre>
<blockquote>
<p>🤖 For more info, check out the <a href="../api/transforms.html#selection-transforms">Selection Transforms API Reference</a></p>
</blockquote>
<h2 id="text-transforms">Text Transforms</h2>
<p>Text transforms act on the text content of the editor. For example, here&apos;s how you&apos;d insert a string of text as a specific point:</p>
<pre><code class="lang-js">Transforms.insertText(editor, <span class="hljs-string">&apos;some words&apos;</span>, {
  <span class="hljs-attr">at</span>: { <span class="hljs-attr">path</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>], <span class="hljs-attr">offset</span>: <span class="hljs-number">3</span> },
})
</code></pre>
<p>Or you could delete all of the content in an entire range from the editor:</p>
<pre><code class="lang-js">Transforms.delete(editor, {
  <span class="hljs-attr">at</span>: {
    <span class="hljs-attr">anchor</span>: { <span class="hljs-attr">path</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>], <span class="hljs-attr">offset</span>: <span class="hljs-number">0</span> },
    <span class="hljs-attr">focus</span>: { <span class="hljs-attr">path</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>], <span class="hljs-attr">offset</span>: <span class="hljs-number">2</span> },
  },
})
</code></pre>
<blockquote>
<p>🤖 For more info, check out the <a href="../api/transforms.html#text-transforms">Text Transforms API Reference</a></p>
</blockquote>
<h2 id="node-transforms">Node Transforms</h2>
<p>Node transforms act on the individual element and text nodes that make up the editor&apos;s value. For example you could insert a new text node at a specific path:</p>
<pre><code class="lang-js">Transforms.insertNodes(
  editor,
  {
    <span class="hljs-attr">text</span>: <span class="hljs-string">&apos;A new string of text.&apos;</span>,
  },
  {
    <span class="hljs-attr">at</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>],
  }
)
</code></pre>
<p>Or you could move nodes from one path to another:</p>
<pre><code class="lang-js">Transforms.moveNodes(editor, {
  <span class="hljs-attr">at</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>],
  <span class="hljs-attr">to</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>],
})
</code></pre>
<blockquote>
<p>🤖 For more info, check out the <a href="../api/transforms.html#node-transforms">Node Transforms API Reference</a></p>
</blockquote>
<h2 id="the-at-option">The <code>at</code> Option</h2>
<p>Many transforms act on a specific location in the document. By default, they will use the user&apos;s current selection. But this can be overridden with the <code>at</code> option.</p>
<p>For example when inserting text, this would insert the string at the user&apos;s current cursor:</p>
<pre><code class="lang-js">Transforms.insertText(editor, <span class="hljs-string">&apos;some words&apos;</span>)
</code></pre>
<p>Whereas this would insert it at a specific point:</p>
<pre><code class="lang-js">Transforms.insertText(editor, <span class="hljs-string">&apos;some words&apos;</span>, {
  <span class="hljs-attr">at</span>: { <span class="hljs-attr">path</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>], <span class="hljs-attr">offset</span>: <span class="hljs-number">3</span> },
})
</code></pre>
<p>The <code>at</code> option is very versatile, and can be used to implement more complex transforms very easily. Since it is a <code>Location</code> it can always be either a <code>Path</code>, <code>Point</code>, or <code>Range</code>. And each of those types of locations will result in slightly different transformations.</p>
<p>For example, in the case of inserting text, if you specify a <code>Range</code> location, the range will first be deleted, collapsing to a single point where your text is then inserted.</p>
<p>So to replace a range of text with a new string you can do:</p>
<pre><code class="lang-js">Transforms.insertText(editor, <span class="hljs-string">&apos;some words&apos;</span>, {
  <span class="hljs-attr">at</span>: {
    <span class="hljs-attr">anchor</span>: { <span class="hljs-attr">path</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>], <span class="hljs-attr">offset</span>: <span class="hljs-number">0</span> },
    <span class="hljs-attr">focus</span>: { <span class="hljs-attr">path</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>], <span class="hljs-attr">offset</span>: <span class="hljs-number">3</span> },
  },
})
</code></pre>
<p>Or, if you specify a <code>Path</code> location, it will expand to a range that covers the entire node at that path. Then, using the range-based behavior it will delete all of the content of the node, and replace it with your text.</p>
<p>So to replace the text of an entire node with a new string you can do:</p>
<pre><code class="lang-js">Transforms.insertText(editor, <span class="hljs-string">&apos;some words&apos;</span>, {
  <span class="hljs-attr">at</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>],
})
</code></pre>
<p>These location-based behaviors work for all the transforms that take an <code>at</code> option. It can be hard to wrap your head around at first, but it makes the API very powerful and capable of expressing many subtly different transforms.</p>
<h2 id="the-match-option">The <code>match</code> Option</h2>
<p>Many of the node-based transforms take a <code>match</code> function option, which restricts the transform to only apply to nodes for which the function returns <code>true</code>. When combined with <code>at</code>, <code>match</code> can also be very powerful.</p>
<p>For example, consider a basic transform that moves a node from one path to another:</p>
<pre><code class="lang-js">Transforms.moveNodes(editor, {
  <span class="hljs-attr">at</span>: [<span class="hljs-number">2</span>],
  <span class="hljs-attr">to</span>: [<span class="hljs-number">5</span>],
})
</code></pre>
<p>Although it looks like it simply takes a path and moves it to another place. Under the hood two things are happening…</p>
<p>First, the <code>at</code> option is expanded to be a range representing all of the content inside the node at <code>[2]</code>. Which might look something like:</p>
<pre><code class="lang-js">at: {
  <span class="hljs-attr">anchor</span>: { <span class="hljs-attr">path</span>: [<span class="hljs-number">2</span>, <span class="hljs-number">0</span>], <span class="hljs-attr">offset</span>: <span class="hljs-number">0</span> },
  <span class="hljs-attr">focus</span>: { <span class="hljs-attr">path</span>: [<span class="hljs-number">2</span>, <span class="hljs-number">2</span>], <span class="hljs-attr">offset</span>: <span class="hljs-number">19</span> }
}
</code></pre>
<p>Second, the <code>match</code> option is defaulted to a function that only matches the specific path, in this case <code>[2]</code>:</p>
<pre><code class="lang-js">match: <span class="hljs-function">(<span class="hljs-params">node, path</span>) =&gt;</span> Path.equals(path, [<span class="hljs-number">2</span>])
</code></pre>
<p>Then Slate iterates over the range and moves any nodes that pass the matcher function to the new location. In this case, since <code>match</code> is defaulted to only match the exact <code>[2]</code> path, that node is moved.</p>
<p>But what if you wanted to move the children of the node at <code>[2]</code> instead?</p>
<p>You might consider looping over the node&apos;s children and moving them one at a time, but this gets very complex to manage because as you move the nodes the paths you&apos;re referring to become outdated.</p>
<p>Instead, you can take advantage of the <code>at</code> and <code>match</code> options to match all of the children:</p>
<pre><code class="lang-js">Transforms.moveNodes(editor, {
  <span class="hljs-comment">// This will again be expanded to a range of the entire node at `[2]`.</span>
  <span class="hljs-attr">at</span>: [<span class="hljs-number">2</span>],
  <span class="hljs-comment">// Matches nodes with a longer path, which are the children.</span>
  <span class="hljs-attr">match</span>: <span class="hljs-function">(<span class="hljs-params">node, path</span>) =&gt;</span> path.length === <span class="hljs-number">2</span>,
  <span class="hljs-attr">to</span>: [<span class="hljs-number">5</span>],
})
</code></pre>
<p>Here we&apos;re using the same <code>at</code> path (which is expanded to a range), but instead of letting it match just that path by default, we&apos;re supplying our own <code>match</code> function which happens to match only the children of the node.</p>
<p>Using <code>match</code> can make representing complex logic a lot simpler.</p>
<p>For example, consider wanting to add a bold mark to any text nodes that aren&apos;t already italic:</p>
<pre><code class="lang-js">Transform.setNodes(
  editor,
  { <span class="hljs-attr">bold</span>: <span class="hljs-literal">true</span> },
  {
    <span class="hljs-comment">// This path references the editor, and is expanded to a range that</span>
    <span class="hljs-comment">// will encompass all the content of the editor.</span>
    <span class="hljs-attr">at</span>: [],
    <span class="hljs-comment">// This only matches text nodes that are not already italic.</span>
    <span class="hljs-attr">match</span>: <span class="hljs-function">(<span class="hljs-params">node, path</span>) =&gt;</span> Text.isText(node) &amp;&amp; node.italic !== <span class="hljs-literal">true</span>,
  }
)
</code></pre>
<p>When performing transforms, if you&apos;re ever looping over nodes and transforming them one at a time, consider seeing if <code>match</code> can solve your use case, and offload the complexity of managing loops to Slate instead.
The <code>match</code> function can examine the children of a node, in <code>node.children</code>, or use <code>Node.parent</code> to examine its parent.</p>
<h2 id="transforms-and-normalization">Transforms and Normalization</h2>
<p>Sequences of Transforms may need to be wrapped in <a href="../api/nodes/editor.html#editorwithoutnormalizingeditor-editor-fn---void--void"><code>Editor.withoutNormalizing</code></a> if the node tree should <em>not</em> be normalized between Transforms.
See <a href="11-normalizing.html#implications-for-other-code">Normalization - Implications for Other Code</a>;</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="03-locations.html" class="navigation navigation-prev " aria-label="Previous page: Locations">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="05-operations.html" class="navigation navigation-next " aria-label="Next page: Operations">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Transforms","level":"3.4","depth":1,"next":{"title":"Operations","level":"3.5","depth":1,"path":"concepts/05-operations.md","ref":"concepts/05-operations.md","articles":[]},"previous":{"title":"Locations","level":"3.3","depth":1,"path":"concepts/03-locations.md","ref":"concepts/03-locations.md","articles":[]},"dir":"ltr"},"config":{"plugins":[],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"mowangjuanzi","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"structure":{"langs":"LANGS.md","readme":"Introduction.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Slate 中文文档","language":"zh-hans","gitbook":"*"},"file":{"path":"concepts/04-transforms.md","mtime":"2022-06-10T04:22:14.769Z","type":"markdown"},"gitbook":{"version":"3.7.3","time":"2022-06-10T04:22:18.961Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

